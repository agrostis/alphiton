<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Mex</title>
    <style type="text/css">
      body {
        font-family: sans-serif;
        background-color: white;
      }
    </style>
    <link href="mex.css" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src="mex.js"></script>
    <script type="text/javascript">
    <!--
      var MEX = makeMexInstance();
      var MEX_TESTS = {
      /**************** @BEGIN TESTS ****************/
      /**************** @END TESTS ****************/
      };
    -->
    </script>
    <style type="text/css">
      div#tests {
        display: table;
        padding: 5pt;
        width: 96%;
      }

      div#tests h3 {
        display: table-cell;
        height: 3em;
        vertical-align: bottom;
      }

      div.test {
        background-color: lightgray;
        display: table-row;
        width: 100%;
      }

      div.test div {
        display: table-cell;
        margin: 5pt;
        padding: 10pt;
      }

      div.test pre {
        overflow: auto;
      }

      div.test .mex {
        background-color: lightsteelblue;
        width: 50%;
        max-width: 500pt;
      }

      div.test .result, div.test .reference {
        width: 25%;
        max-width: 250pt;
        border-left: 1px solid grey;
      }

      div.test .error {
        background-color: lightcoral;
      }

      div.test .ok {
        background-color: lightgreen;
      }
    </style>
    <script type="text/javascript" src="jquery-2.1.3.min.js"></script>
    <script type="text/javascript">
    <!--

      function addMexTestDisplay(id) {
          $('<h3/>', {'html': id}).appendTo($('#tests'));
          var spec = MEX_TESTS[id];
          var testblock = $('<div class="test"/>').appendTo($('#tests'));
          testblock.append($('<div/>', {'html': $('<pre/>', {'html': spec.mex}),
                                        'class': 'mex'}));
          var result_dom, result, result_class;
          var reference_dom, reference, reference_class;
          var rootContext = MEX.ROOT_CONTEXT;
          try {
              var ctx = false;
              if (spec.use.length > 0) {
                  ctx = true;
                  for (var i = 0; i < spec.use.length; ++i) {
                      ctx = MEX.mex(MEX_TESTS[spec.use[i]].mex, ctx);
                  }
                  MEX.ROOT_CONTEXT = ctx;
              }
              result_dom = MEX.mex(spec.mex);
              result = MEX.render(result_dom, document);
              result_class = 'ok';
          } catch (e) {
              result = $('<pre/>', {'html': 'Caught error: ' + e});
              result_class = 'error';
          }
          try {
              reference_dom = MEX.DOM_ROOT_WRAPPER(MEX.jsonToDom(spec.reference));
              reference = MEX.render(reference_dom, document);
              reference_class = MEX.domEqual(result_dom, reference_dom) ? 'ok' : 'error';
          } catch (e) {
              reference = $('<pre/>', {'html': 'Caught error: ' + e});
              reference_class = 'error';
          }
          MEX.ROOT_CONTEXT = rootContext;
          testblock.append($('<div/>', {'html': result,
                                        'class': 'result ' + result_class}));
          testblock.append($('<div/>', {'html': reference,
                                        'class': 'reference ' + reference_class}));
      }

      $(document).ready(function() {
          $.each(MEX_TESTS, addMexTestDisplay);
      });

    -->
    </script>
  </head>
  <body>
  <h2>Welcome to Mex!</h2>
  <div id="tests"></div>
  </body>
</html>
